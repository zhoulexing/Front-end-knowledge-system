## 前言
架构，在前端会更负责，设计领域更广。在实现的过程中，除了考虑代码的**可用性**、**性能**、**模型构建**、**组件复用**等问题外，
还有前端特有的**平台设定**、**浏览器兼容**、**交互设计**、**用户体验**等相关的问题。在“大前端”的背景下，还需要深入**移动端设计**、
**桌面应用**、**物联网**等相关的问题。

### 前端架构

**没有一种架构能满足未来的需求**。在软件的生命周期中，架构可以不断地优化，持续地变好，使得架构可以适用于当前的场景。
所以**架构是可以改变的，架构是需要变化的**。

01. 为什么需要软件架构？

软件开发就像造房子一样，需要先规划、设计、实施，然后才能入住。对于软件开发来说也是类似的，需要规划、设计、开发，然后才能用。

02. 架构的设计

   - 收集利益相关者的需求
   - 与相应的技术人员讨论，了解架构上的潜在限制
   - 寻找潜在的可行性技术方案
   - 整理出功能列表中的功能性需求和跨功能性需求
   - 找出会严重影响开发的风险点
   - 和技术委员会、利益相关者反复确认方案
   - 对架构设计进行概念证明
   - 细化架构的部分实施细节
   - 结合技术和业务，进行需求排期

03. 架构设计原则

   - 不多也不少
   - 演进式
   - 持续性

04. 前端架构层次设计

   - 系统级
   - 应用级
   - 模块级
   - 组件级

### 架构基础：工作流设计

前端基础架构是一系列工具与流程的集合，它是我们在启动一个项目时所需要制定的一系列规范和规划。

01. 代码之旅：基础规范

   - 规范代码组织结构
   - 统一代码风格
   - 组件、函数等命名规范
   - 开发工具规范

02. 代码组织决定应用架构

   - 打开**README**了解应该阅读哪些相关的资料
   - 阅读**package.json**了解系统的基础设施、使用了哪些组件库，以及配置了哪些构建脚本
   - 浏览主目录下的一个个文件，了解系统的一些插件的配置
   - 进入项目代码中阅读和了解

03. 统一代码风格，避免架构腐烂

04. 使用Lint规范代码

05. 规范化命名，提升可读性

   - 命名法：驼峰命名法(getTypeById)、下划线命名(get_type_by_id)、匈牙利命名(熟悉+类型+对象描述如：strFirstName)

06. 规范开发工具，提升开发效率

07. 项目的文档化：README搭建指南

   - 支持运行的环境
   - 必要的依赖准备，以及如何搭建
   - 项目的安装指南
   - 线上的示例或最后哦的运行环境
   - 相关的文档链接
   - 相关人员的联系方式，讨论群

08. 绘制架构图：减少沟通成本

09. 可编辑文档库：提升协作性

10. 记录架构决策：轻量级架构决策记录

   - 标题
   - 日期
   - 描述决策相关的状态，包含提议、通过、完成、已弃用、已取代等
   - 价值中立的、用于描述事实上下文的背景
   - 应对这种场景的相应的决策
   - 记录应用决策后产生的结果
   

``` 
0001-examples.md
# 1. examples

## 日期

2020-01-01

## 状态

2020-01-01  提议

## 背景

在这里补充上下文。。。

## 决策

在这里补充决策信息。。。

## 后果 

在这里补充后果
```

11. 可视化文档：注重代码的可读性

12. 看板工具：统一管理业务知识

13. 提交信息：每次代码提交文档化

14. 通过流程化提高代码质量

15. 使用工具提升代码质量

   - 代码扫描工具：Sonar、CheckStyle
   - IED快速重构

16. 测试策略

   - 单元测试
   - 组件测试
   - 契约/接口测试
   - E2E集成测试/端到端测试

### 架构基础：设计构建流

构建系统是一个web应用不可缺少的一部分，其核心用途是，帮助开发者从源代码开发开始，构建出最后可用的目标软件。
包含一下一些事情：**依赖管理及安装**、**优化开发环境**、**代码质量检测**、**编译及打包**、**测试及部署**。

01. 依赖管理工具

   - bower
   - npm/yarn/cnpm
   - 本地文件

02. 软件包源管理

   - 基于源码版本管理服务器(公有/私有npm服务器、git服务器)

``` 
"dependencoes": {
    "adr": "git+http://github.com/phodal/adr/#v1.7.0"
}
```

   - 本地的软件依赖包

``` 
package.json
"aofe": "file:aofe"
```

   - 前端应用的编译
   - JavaScript的编译
   - css的编译
   - css in JavaScript
   - 模版编译

03. 前端代码的打包

04. 设计构建流

   - 构建工具：自动化任务
   - 使用包管理工具构建(npm)
   - 使用构建工具(Grunt/Gulp)
   - 使用打包工具构建(webpack)
   - 实现构建流

05. 持续交付

   - 部署方式(持续部署：完成即部署，常用于测试环境、自动化部署：需要人为介入、手动部署：全程人为操作)
   - 设计持续集成
   - 自动化部署
   - 环境配置
   - 开发环境配置
   - 线上调试

## 确定选用的框架

*   react + redux|mobx + redux-thunk|redux-promise-middleware|redux-saga + antd
*   vue + vuex + element-ui
*   angular
*   jquery + bootstrap
*   ... 

## 选择相应的模板或脚手架

*   ant-design-pro
*   react-boilerplate
*   vue-element-admin
*   create-react-app
*   dva-cli
*   umi-cli
*   vue-cli
*   ... 

## 确定目录结构

|-- /
|-- src/ 源代码目录
|-- assets/ 静态资源目录
|-- common/ 公共部分目录
|-- components/ 公共组件目录
|-- layouts/ 布局目录
|-- utils/ 工具目录
|-- routes/ 路由目录
|-- index.js 入口文件
|-- router.js 全局路由
|-- ... 
|-- test/ 测试目录
|-- docs/ 文档目录
|-- package.json npm 项目文件
|-- README.md 项目说明文件
|-- CHANGELOG.md 版本更新记录
|-- .gitignore git 忽略配置文件
|-- .gitattributes git 属性配置
|-- .editorconfig 编辑器配置文件
|-- .npmrc npm 配置文件
|-- .npmignore npm 忽略配置文件
|-- .eslintrc eslint 配置文件
|-- .eslintignore eslint 忽略配置文件
|-- .stylelintrc stylelint 配置文件
|-- .stylelintignore stylelint 忽略配置文件
|-- .prettierrc prettier 配置文件
|-- .prettierignore prettier 忽略配置文件
|-- .babelrc babel 配置文件
|-- webpack.config.js webpack 配置文件
|-- rollup.config.js rollup 配置文件
|-- jest.config.js jest 配置文件
|-- md-sync.config.js 自动拷到服务器
|-- gulpfile.js gulp 配置文件
|-- ... 

## 相关配置文件

*   webpack.config.js

    -   模式 mode
    -   入口 entry
    -   出口 output
    -   帮助快速定位代码在文件中的位置 devtool
    -   开发中 devServer
    -   模块化 js,ts,css,less,scss,url,jpg,png,icon module
    -   插件 plugins
    -   解析 resolve
        -   别名方便引入 alias
        -   文件引入后缀 extensions
    -   优化 optimization
    -   antd 按需加载 babel-plugin-import
    -   html 动态模版 html-webpack-plugin
    -   全局变量 webpack.definePlugin
    -   组件懒加载 @babel/plugin-syntax-dynamic-import
    -   动态链接库文件 webpack.dllPlugin
    -   装饰器功能 @babel/plugin-proposal-decorators
    -   class 里属性可以不写 this 功能 @babel/plugin-proposal-class-properties
    -   es6、es7 等高级 API 语法 @babel/polyfill|@babel/plugin-transform-runtime
    -   热更新 webpack.HotModuleReplacementPlugin
    -   代理 devServer: { proxy: {"/api/\*": { target: "http://127.0.0.1:3000",secure: false //接受 https } }

*   .babelrc

    -   presets 预设
    -   plugins 插件
    -   env 环境

*   postcss.config.js

    

``` 
    module.exports = {
        plugins: {
            autoprefixer: {},
        },
    };
    ```

*   md-sync.config.js

    

``` 
    module.exports = [{
        src: ["./client/**/*"],
        remotePath: "/opt/zlx/",
        server: {
            ignoreErrors: true,
            sshConfig: {
            host: "192.168.10.82",
            username: "root",
            password: "hzjs@123"
        }
    }];
    ```

*   .eslintrc

    

``` 
    module.exports = {
        root: true,
        env: { node: true, },
        extends: [ 'plugin:vue/essential', '@vue/airbnb', ],
        rules: {
            'no-console': process.env.NODE_ENV === 'production' ? 'error' : 'off',
            'no-debugger': process.env.NODE_ENV === 'production' ? 'error' : 'off',
        },
        parserOptions: { parser: 'babel-eslint' },
    };
    ```

*   .stylelintrc

    

``` 
    {
        "extends": "@thoughtbot/stylelint-config"
    }
    ```

## 功能架构

*   react

    -   将 react, react-router 连接 redux

        -   下载安装包
        -   创建 store
        -   全局 loading 状态
        -   处理状态缓存 reselect

    -   骨架屏

        -   Skeleton

    -   字体图标

        -   引入 Font Awesome
        -   引入 iconfont

    -   换肤

        -   antd-theme-generator

    -   切换语言
        -   react-intl

## 测试

*   测试框架 Mocha, Jest, Jasmine, Karma
*   断言库 chai.js, should.js
*   ui 层 enzyme

