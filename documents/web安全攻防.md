## XSS 跨站脚本攻击

1. 非持久性 XSS（反射型 XSS）

    一般是通过给别人发送带有恶意脚本代码的 URL，当 URL 被打开时，特有的恶意代码参数被 HTML 解析、执行。
    例如在 url 的参数后面添加脚本，系统拿到这个参数之后，没做转译等安全处理，直接解析，可能会造成 XSS 攻击。

特征：

-   即使性，不经过服务器存储；
-   攻击者需要诱骗点击，必须通过用户点击链接才能发起；
-   反馈率低，所以较难发现和响应修复；
-   盗取用户敏感保密信息。

防止：

-   页面渲染的所有内容或数据必须来自服务器端；
-   尽量不要从 URL、document.referrer、document.forms 等这种 API 中获取数据渲染；
-   前端渲染的时候对任何的字段都需要做 escape 转义编码。

## CSRF 跨站请求伪造

利用用户已登录的身份，在用户毫不知情的情况下，以用户的名义完成非法操作。
比如用户登陆了 A 网站，然后在没有登出的情况下，访问了恶意网站 B，且站点
A 没有做任何 CSRF 防御，导致攻击。

三个条件：

-   用户已经登录了站点 A，并在本地登录了 cookie；
-   在用户没有登出站点 A 的情况下，访问了恶意用户提供的站点 B；
-   站点 A 没有做任何 CSRF 防御。

防止：

-   get 请求不对数据进行修改；
-   不让第三方网站访问到用户 cookie；
-   阻止第三方网站访问接口；
-   请求时附带验证信息，比如验证码或者 Token。

## 点击劫持

攻击者将需要攻击的网站通过 iframe 嵌入到自己的网站，然后诱导用户点击。

特点：

-   隐蔽性较高；
-   UI 覆盖攻击；
-   利用 iframe 或者其他标签的属性。

防止：

-   设置 http 头 X-FRAME-OPTIONS，防止 iframe 嵌套点击，有三个值：

    -   DENY：不允许通过 iframe 的方式展示；
    -   SAMEORIGIN：表示页面可以在相同域名下通过 iframe 的方式展示;
    -   ALLOW-FROM: 表示页面可以在指定来源的 iframe 中展示

-   JavaScript 防御

## URL 跳转漏洞

利用可信的网站来伪造恶意的链接，用户点击后，跳到恶意的网站中。
例如在url后面添加一个回调地址，然后系统会根据回调地址跳转到对应的页面。

实现：

-   Header 头跳转；
-   Javascript 跳转；
-   META 标签跳转。

防止：

-   referer 的限制；
-   加入有效性验证 Token。

## SQL 注入

SQL 注入是一种常见的 Web 安全漏洞，攻击者利用这个漏洞，可以访问或修改数据，或者利用潜在的数据库漏洞进行攻击。

过程：

-   获取用户请求参数；
-   拼接到代码当中；
-   SQL 语句按照我们构造参数的语义执行成功。

防止：

-   严格限制 Web 应用的数据库的操作权限；
-   后端代码检查输入的数据是否符合预期；
-   对进入数据库的特殊字符（'，"，\，<，>，&，\*，; 等）进行转义处理，或编码转换；
-   所有的查询语句建议使用数据库提供的参数化查询接口。

## OS 命令注入攻击

OS 命令注入和 SQL 注入差不多，只不过 SQL 注入是针对数据库的，而 OS 命令注入是针对操作系统的。

防止：

-   后端对前端提交内容进行规则限制（比如正则表达式）；
-   在调用系统命令前对所有传入参数进行命令行参数转义过滤；
-   不要直接拼接命令语句，借助一些工具做拼接、转义预处理，例如 Node.js 的 shell-escape npm 包。
